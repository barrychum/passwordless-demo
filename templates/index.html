<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>User Registration</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="{{ url_for('static', filename='simplewebauthnbrowser.10.0.0.umd.min.js') }}"></script>
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
</head>

<body>
    <header class="header">
        <h1>WebAuthn Passwordless Authentication Demo</h1>
    </header>

    <div class="container">
        <main class="main-content">
            <section class="intro">
                <h2>Authentication Details</h2>
                <p>rp_name: {{rp_name}}</p>
                <p>rp_id: {{rp_id}}</p>
                <p>origin: {{origin}}</p>
            </section>

            <section class="form-container">
                <label for="username">Enter your username:</label>
                <input type="text" name="username" id="username" value="{{ username }}" />
                <div class="form-buttons">
                    <button type="button" onclick="registerUser()">Register</button>
                    <button type="button" onclick="authenticateUser()">Authenticate</button>
                </div>
            </section>
        </main>

        <aside class="status-container">
            <p>Status:</p>
            <span id="status"></span>
        </aside>
    </div>

    <section class="collapsible-sections">
        <div class="section" id="section1">
            <a class="collapse-trigger" href="#" onclick="toggleSection('reg-options'); return false;">
                Registration options</a>
            <div class="content" id="reg-options"></div>
        </div>
        <div class="section" id="section2">
            <a class="collapse-trigger" href="#" onclick="toggleSection('reg-result'); return false;">
                Registration result</a>
            <div class="content" id="reg-result"></div>
        </div>
        <div class="section" id="section3">
            <a class="collapse-trigger" href="#" onclick="toggleSection('reg-ver-result'); return false;">
                Registration verification result</a>
            <div class="content" id="reg-ver-result"></div>
        </div>
        <div class="section" id="section4">
            <a class="collapse-trigger" href="#" onclick="toggleSection('auth-options'); return false;">
                Authentication options</a>
            <div class="content" id="auth-options"></div>
        </div>
        <div class="section" id="section5">
            <a class="collapse-trigger" href="#" onclick="toggleSection('auth-result'); return false;">
                Authentication result</a>
            <div class="content" id="auth-result"></div>
        </div>
        <div class="section" id="section6">
            <a class="collapse-trigger" href="#" onclick="toggleSection('auth-ver-result'); return false;">
                Authentication verification result</a>
            <div class="content" id="auth-ver-result"></div>
        </div>
    </section>

    <footer class="footer">
        <p>&copy; 2024 WebAuthn Demo. All rights reserved.</p>
    </footer>

    <script>
        function toggleSection(id) {
            const element = document.getElementById(id);
            if (element.style.display === "none" || element.style.display === "") {
                element.style.display = "block";
            } else {
                element.style.display = "none";
            }
        }

        // Initialize all sections as collapsed
        document.addEventListener('DOMContentLoaded', function () {
            document.querySelectorAll('.content').forEach(function (content) {
                content.style.display = 'none';
            });
            setStatusMessage("Please enter username and click one of the buttons");
        });
    </script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>

</html>
